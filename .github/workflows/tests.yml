name: 🎭 Tests
on:
  push:
    paths-ignore:
      - .chglog/**
      - .github/**
      - '!.github/workflows/tests.yml'
      - public/**
      - .editorconfig
      - .gitattributes
      - .gitignore
      - .htaccess
      - CHANGELOG.md
      - code-of-conduct.md
      - CONTRIBUTING.md
      - LICENSE.md
      - README.md
jobs:
  # ----------------------
  #   Silverstipe / PHP
  # ----------------------
  # behat:
  #   name: 🐝 Behat
  #   uses: syntro-opensource/workflows/.github/workflows/silverstripe-behat.yml@master
  phpstan:
    name: 🔺 PHPStan
    uses: syntro-opensource/workflows/.github/workflows/silverstripe-phpstan.yml@master
    with:
      dir: app/src/
  phpunit:
    strategy:
      matrix:
        php:
          - '7.4'
          - '8.0'
    name: 🧩 PHPUnit
    uses: syntro-opensource/workflows/.github/workflows/silverstripe-phpunit.yml@master
    with:
      suite: app/tests/
      php_version: ${{ matrix.php }} # Choose the PHP Version you are using in prod!
  phpcs:
    name: 🔮 PHPcs
    uses: syntro-opensource/workflows/.github/workflows/silverstripe-phpcs.yml@master
    with:
      dir: app/
  # ----------------------
  #   Client
  # ----------------------
  eslint-back:
    name: 🔮 ESLint - Backend
    uses: syntro-opensource/workflows/.github/workflows/js-eslint.yml@master
    with:
      dir: app/client/src/global/
      configfile: app/client/src/global/.eslintrc
